import{l as D,m as I}from"./index-hLNS-uRs.js";import{e as M,r as O}from"./ruleUtils-B_kFGKyT.js";import{d as T,b as i,r as n,o as v,e as w,a as e,w as t,g as a,F as E,j as G,c as J,t as p,u as j,h as f}from"./index-DXb1Hc3w.js";const K=f("small",null," Enviar encuesta de satisfacción ",-1),P=f("small",null," cancelar ",-1),Q=f("small",null," Enviar ",-1),te=T({__name:"ListHistoy",props:{document:{type:String},person:{type:Object},person_type:{type:String}},setup(A){var b,x;const d=A,s=i(!1),y=i([]),B=i(null),r=i({attention_id:"",person_type:d.person_type,person_id:(b=d.person)==null?void 0:b.id,email:(x=d.person)==null?void 0:x.email}),_=i(!1),$=async c=>{s.value=!0,r.value.attention_id=c.id},h=async()=>{var c,o;if(!((o=(c=r.value)==null?void 0:c.email)!=null&&o.match(/^[a-zA-Z0-9._-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,6}$/))){alert("Correo no válido");return}_.value=!0,await D(r.value),_.value=!1,s.value=!1},g=async()=>{y.value=await I(d.document)};return g(),(c,o)=>{const z=n("v-toolbar-title"),H=n("v-spacer"),k=n("v-icon"),u=n("v-btn"),N=n("v-toolbar"),C=n("v-card-title"),m=n("v-card-text"),V=n("v-card-actions"),S=n("v-card"),Z=n("v-text-field"),q=n("v-col"),F=n("v-row"),L=n("v-dialog"),R=n("v-container");return v(),w(E,null,[e(N,null,{default:t(()=>[e(z,null,{default:t(()=>[a("Historial de Atenciones")]),_:1}),e(H),e(u,{icon:"",onClick:g},{default:t(()=>[e(k,null,{default:t(()=>[a("mdi-refresh")]),_:1})]),_:1})]),_:1}),e(R,null,{default:t(()=>[(v(!0),w(E,null,G(y.value,(l,U)=>(v(),J(S,{key:U,variant:"tonal",class:"mb-4"},{default:t(()=>[e(C,null,{default:t(()=>[a(p(l.type_attention_name),1)]),_:2},1024),e(m,null,{default:t(()=>[a(p(l.description),1)]),_:2},1024),e(m,{class:"d-flex justify-end"},{default:t(()=>[e(k,{class:"me-2"},{default:t(()=>[a(" mdi-calendar ")]),_:1}),a(" "+p(l.created_at),1)]),_:2},1024),e(V,{class:"d-flex justify-end"},{default:t(()=>[e(u,{"prepend-icon":"mdi-send",color:"orange",variant:"tonal",density:"compact",onClick:W=>$(l)},{default:t(()=>[K]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1024))),128)),e(L,{modelValue:s.value,"onUpdate:modelValue":o[3]||(o[3]=l=>s.value=l),"max-width":"500"},{default:t(()=>[e(S,null,{default:t(()=>[e(C,null,{default:t(()=>[a(" Enviar encuesta de satisfacción ")]),_:1}),e(m,null,{default:t(()=>[e(F,null,{default:t(()=>[e(q,{cols:"12"},{default:t(()=>[e(Z,{modelValue:r.value.email,"onUpdate:modelValue":o[0]||(o[0]=l=>r.value.email=l),modelModifiers:{trim:!0},rules:[j(M),j(O)],label:"Correo Electrónico",hint:"Ingrese el correo electrónico al que se enviará la encuesta","persistent-hint":"",ref_key:"emailRef",ref:B},null,8,["modelValue","rules"])]),_:1})]),_:1})]),_:1}),e(V,null,{default:t(()=>[e(u,{color:"secondary",type:"button",onClick:o[1]||(o[1]=l=>s.value=!1)},{default:t(()=>[P]),_:1}),e(u,{color:"primary",type:"button",onClick:o[2]||(o[2]=l=>h()),loading:_.value},{default:t(()=>[Q]),_:1},8,["loading"])]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})],64)}}});export{te as _};
