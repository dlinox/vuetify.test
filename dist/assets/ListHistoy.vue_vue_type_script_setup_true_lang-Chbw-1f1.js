import{p as U,q as D}from"./index-CyD1Xz_k.js";import{e as I,r as M}from"./ruleUtils-DvAtGyw3.js";import{d as O,b as i,r as n,o as v,e as V,a as e,w as t,g as l,F as w,k as T,c as G,t as p,B as J,u as S,h as B}from"./index-5wKNqEKW.js";const K=B("small",null," cancelar ",-1),P=B("small",null," Enviar ",-1),te=O({__name:"ListHistoy",props:{document:{type:String},person:{type:Object},person_type:{type:String}},setup(h){var g,k;const d=h,s=i(!1),f=i([]),E=i(null),r=i({attention_id:"",person_type:d.person_type,person_id:(g=d.person)==null?void 0:g.id,email:(k=d.person)==null?void 0:k.email}),_=i(!1),Q=async c=>{s.value=!0,r.value.attention_id=c.id},N=async()=>{var c,o;if(!((o=(c=r.value)==null?void 0:c.email)!=null&&o.match(/^[a-zA-Z0-9._-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,6}$/))){alert("Correo no válido");return}_.value=!0,await U(r.value),_.value=!1,s.value=!1},y=async()=>{f.value=await D(d.document)};return y(),(c,o)=>{const A=n("v-toolbar-title"),$=n("v-spacer"),b=n("v-icon"),u=n("v-btn"),j=n("v-toolbar"),x=n("v-card-title"),m=n("v-card-text"),q=n("v-card-actions"),C=n("v-card"),z=n("v-text-field"),H=n("v-col"),Z=n("v-row"),F=n("v-dialog"),L=n("v-container");return v(),V(w,null,[e(j,null,{default:t(()=>[e(A,null,{default:t(()=>[l("Historial de Atenciones")]),_:1}),e($),e(u,{icon:"",onClick:y},{default:t(()=>[e(b,null,{default:t(()=>[l("mdi-refresh")]),_:1})]),_:1})]),_:1}),e(L,null,{default:t(()=>[(v(!0),V(w,null,T(f.value,(a,R)=>(v(),G(C,{key:R,variant:"tonal",class:"mb-4"},{default:t(()=>[e(x,null,{default:t(()=>[l(p(a.type_attention_name),1)]),_:2},1024),e(m,null,{default:t(()=>[l(p(a.description),1)]),_:2},1024),e(m,{class:"d-flex justify-end"},{default:t(()=>[e(b,{class:"me-2"},{default:t(()=>[l(" mdi-calendar ")]),_:1}),l(" "+p(a.created_at),1)]),_:2},1024),J("",!0)]),_:2},1024))),128)),e(F,{modelValue:s.value,"onUpdate:modelValue":o[3]||(o[3]=a=>s.value=a),"max-width":"500"},{default:t(()=>[e(C,null,{default:t(()=>[e(x,null,{default:t(()=>[l(" Enviar encuesta de satisfacción ")]),_:1}),e(m,null,{default:t(()=>[e(Z,null,{default:t(()=>[e(H,{cols:"12"},{default:t(()=>[e(z,{modelValue:r.value.email,"onUpdate:modelValue":o[0]||(o[0]=a=>r.value.email=a),modelModifiers:{trim:!0},rules:[S(I),S(M)],label:"Correo Electrónico",hint:"Ingrese el correo electrónico al que se enviará la encuesta","persistent-hint":"",ref_key:"emailRef",ref:E},null,8,["modelValue","rules"])]),_:1})]),_:1})]),_:1}),e(q,null,{default:t(()=>[e(u,{color:"secondary",type:"button",onClick:o[1]||(o[1]=a=>s.value=!1)},{default:t(()=>[K]),_:1}),e(u,{color:"primary",type:"button",onClick:o[2]||(o[2]=a=>N()),loading:_.value},{default:t(()=>[P]),_:1},8,["loading"])]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})],64)}}});export{te as _};
