import{a as T,D as M}from"./data-table.constants-B0R7xaSt.js";import{p as b,d as D,b as _,r as n,o as P,c as $,w as l,y as B,a as e,f as R,g as j,t as E,x as F,m as N}from"./index-C8sRgYPy.js";const G=async s=>{try{let r=localStorage.getItem("token");return(await b(r).post("/users/items",s)).data}catch(r){return console.error(r),T}},q=async s=>{try{let r=localStorage.getItem("token");return await b(r).post("/users",s),!0}catch(r){return console.error(r),!1}},z=async s=>{try{let r=localStorage.getItem("token");return await b(r).put(`/users/${s.id}`,s),!0}catch(r){return console.error(r),!1}},H=async()=>{try{let s=localStorage.getItem("token");return(await b(s).get("/selects/offices")).data}catch(s){return console.error(s),[]}},J=async()=>{try{let s=localStorage.getItem("token");return(await b(s).get("/selects/roles")).data}catch(s){return console.error(s),[]}},K={id:null,name:"",paternal_surname:"",maternal_surname:"",document_type:"001",document_number:"",office_id:null,role_id:null,email:"",password:"",status:!0,is_editable:!1},O=D({__name:"Form",props:{formState:{type:Object},offices:{type:Array,default:()=>[]},roles:{type:Array,default:()=>[]}},emits:["onSuccess"],setup(s,{emit:r}){const d=r,f=_(!1),t=_({...K,...s.formState}),c=async v=>{f.value=!0,t.value.id?await z(t.value)&&(d("onSuccess"),v.value=!1):await q(t.value)&&(d("onSuccess"),v.value=!1),f.value=!1};return(v,a)=>{const p=n("v-text-field"),i=n("v-col"),m=n("v-combobox"),g=n("v-select"),x=n("v-switch"),V=n("v-row"),I=n("v-card-item"),y=n("v-btn"),S=n("v-spacer"),k=n("v-card-actions"),U=n("v-card"),C=n("v-form"),w=n("v-dialog");return P(),$(w,{"max-width":"700"},{activator:l(({props:u})=>[B(v.$slots,"btn",{activator:u})]),default:l(({isActive:u})=>[e(C,{onSubmit:R(o=>c(u),["prevent"])},{default:l(()=>[e(U,{title:t.value.id?"Editar":"Crear"},{default:l(()=>[e(I,null,{default:l(()=>[e(V,null,{default:l(()=>[e(i,{cols:"12",md:"4"},{default:l(()=>[e(p,{modelValue:t.value.document_number,"onUpdate:modelValue":a[0]||(a[0]=o=>t.value.document_number=o),label:"DNI"},null,8,["modelValue"])]),_:1}),e(i,{cols:"12",md:"8"},{default:l(()=>[e(p,{modelValue:t.value.name,"onUpdate:modelValue":a[1]||(a[1]=o=>t.value.name=o),label:"Nombre"},null,8,["modelValue"])]),_:1}),e(i,{cols:"12",md:"6"},{default:l(()=>[e(p,{modelValue:t.value.paternal_surname,"onUpdate:modelValue":a[2]||(a[2]=o=>t.value.paternal_surname=o),label:"Apellido Paterno"},null,8,["modelValue"])]),_:1}),e(i,{cols:"12",md:"6"},{default:l(()=>[e(p,{modelValue:t.value.maternal_surname,"onUpdate:modelValue":a[3]||(a[3]=o=>t.value.maternal_surname=o),label:"Apellido Materno"},null,8,["modelValue"])]),_:1}),e(i,{cols:"12"},{default:l(()=>[j(E(t.value.office_id)+" ",1),e(m,{modelValue:t.value.office_id,"onUpdate:modelValue":a[4]||(a[4]=o=>t.value.office_id=o),items:[{value:null,title:"Todas las oficinas (no seleccionar ninguna)"},...s.offices],label:"Oficina",hint:"Selecciona una oficina, si no seleccionas ninguna se asignará a todas las oficinas","persistent-hint":"","return-object":!1},null,8,["modelValue","items"])]),_:1}),e(i,{cols:"12"},{default:l(()=>[e(g,{modelValue:t.value.role_id,"onUpdate:modelValue":a[5]||(a[5]=o=>t.value.role_id=o),items:s.roles,label:"Rol"},null,8,["modelValue","items"])]),_:1}),e(i,{cols:"12"},{default:l(()=>[e(p,{modelValue:t.value.email,"onUpdate:modelValue":a[6]||(a[6]=o=>t.value.email=o),label:"Correo"},null,8,["modelValue"])]),_:1}),e(i,{cols:"12"},{default:l(()=>[e(p,{modelValue:t.value.password,"onUpdate:modelValue":a[7]||(a[7]=o=>t.value.password=o),label:"Contraseña",type:"password",autocomplete:"off"},null,8,["modelValue"])]),_:1}),e(i,{cols:"12"},{default:l(()=>[e(x,{label:t.value.status?"Activo":"Inactivo",modelValue:t.value.status,"onUpdate:modelValue":a[8]||(a[8]=o=>t.value.status=o),color:"blue-darken-4",inset:""},null,8,["label","modelValue"])]),_:1})]),_:1})]),_:1}),e(k,null,{default:l(()=>[e(y,{text:"Cancel",onClick:o=>u.value=!1},null,8,["onClick"]),e(S),e(y,{text:"Guardar",color:"primary",type:"submit",loading:f.value},null,8,["loading"])]),_:2},1024)]),_:2},1032,["title"])]),_:2},1032,["onSubmit"])]),_:3})}}}),L=D({__name:"DataTable",setup(s){const r=_([]),d=_([]),f=[{title:"Nombre",sortable:!0,value:"name"},{title:"Apellido Paterno",sortable:!0,value:"paternal_surname"},{title:"Apellido Materno",sortable:!0,value:"maternal_surname"},{title:"Número de Documento",sortable:!0,value:"document_number"},{title:"Correo Electrónico",sortable:!0,value:"email"},{title:"Estado",sortable:!0,value:"status"},{title:"",value:"actions"}],A=[{title:"Activo",value:!0},{title:"Inactivo",value:!1}],t=_(!1),c=_({...M}),v=_({...T}),a=async i=>{t.value=!0,i.value={...i.value,...i},v.value=await G(i.value),t.value=!1};return F(async()=>{await a(c.value),r.value=await H(),d.value=await J()}),(i,m)=>{const g=n("v-btn"),x=n("v-text-field"),V=n("v-col"),I=n("v-select"),y=n("v-row"),S=n("v-card-item"),k=n("v-chip"),U=n("v-data-table-server"),C=n("v-card");return P(),$(C,null,{default:l(()=>{var w;return[e(S,null,{default:l(()=>[e(y,{justify:"space-between"},{default:l(()=>[e(V,{cols:"12",md:"5",class:"d-flex justify-end align-end"},{default:l(()=>[e(O,{onOnSuccess:m[0]||(m[0]=u=>a(c.value)),offices:r.value,roles:d.value},{btn:l(({activator:u})=>[e(g,N(u,{color:"primary",icon:"mdi-plus-circle-outline",class:"me-2"}),null,16)]),_:1},8,["offices","roles"]),e(x,{modelValue:c.value.search,"onUpdate:modelValue":m[1]||(m[1]=u=>c.value.search=u),label:"Buscar"},null,8,["modelValue"])]),_:1}),e(V,{cols:"12",md:"2"},{default:l(()=>[e(I,{modelValue:c.value.filters.status,"onUpdate:modelValue":[m[2]||(m[2]=u=>c.value.filters.status=u),m[3]||(m[3]=u=>a(c.value))],label:"Estado",items:A,clearable:""},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(U,{"items-per-page":c.value.itemsPerPage,"onUpdate:itemsPerPage":m[5]||(m[5]=u=>c.value.itemsPerPage=u),headers:f,items:(w=v.value)==null?void 0:w.data,"items-length":v.value.total,search:c.value.search,"multi-sort":"",loading:t.value,"item-value":"id","items-per-page-text":"Número de filas por página:","onUpdate:options":a},{"item.status":l(({item:u})=>[e(k,{color:u.status?"info":"error"},{default:l(()=>[j(E(u.status?"Activo":"Inactivo"),1)]),_:2},1032,["color"])]),"item.actions":l(({item:u})=>[e(O,{"form-state":u,onOnSuccess:m[4]||(m[4]=o=>a(c.value)),offices:r.value,roles:d.value},{btn:l(({activator:o})=>[e(g,N(o,{density:"comfortable",icon:"mdi-pencil",class:"text-button",variant:"tonal"}),null,16)]),_:2},1032,["form-state","offices","roles"])]),_:1},8,["items-per-page","items","items-length","search","loading"])]}),_:1})}}}),X=D({__name:"index",setup(s){return(r,d)=>(P(),$(L))}});export{X as default};
