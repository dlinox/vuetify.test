import{D as R}from"./data-table.constants-C9jLg9DU.js";import{v as P,d as A,b as f,r as o,o as U,c as C,w as a,y as q,a as e,f as F,u as E,l as G,m as B,n as N,g as h,t as j}from"./index-5wKNqEKW.js";import{r as T}from"./ruleUtils-DvAtGyw3.js";const M=async i=>{try{let r=localStorage.getItem("token");return(await P(r).post("/types-attention/items",i)).data}catch(r){return console.error(r),R}},z=async i=>{try{let r=localStorage.getItem("token");return await P(r).post("/types-attention",i),!0}catch(r){return console.error(r),!1}},H=async i=>{try{let r=localStorage.getItem("token");return await P(r).put(`/types-attention/${i.id}`,i),!0}catch(r){return console.error(r),!1}},J={id:null,type:null,name:"",status:!0},O=A({__name:"Form",props:{formState:{type:Object,default:()=>({})}},emits:["onSuccess"],setup(i,{emit:r}){const p=r,v=f(!1),n=i,m=f(null),s=f({...J,...n.formState}),y=async l=>{var _,c;const{valid:u}=await((_=m.value)==null?void 0:_.validate());u&&(v.value=!0,s.value.id?await H(s.value)&&(p("onSuccess"),l.value=!1):await z(s.value)&&((c=m.value)==null||c.reset(),p("onSuccess"),l.value=!1),v.value=!1)};return(l,u)=>{const _=o("v-text-field"),c=o("v-col"),b=o("v-select"),D=o("v-switch"),I=o("v-row"),g=o("v-card-item"),V=o("v-btn"),$=o("v-spacer"),w=o("v-card-actions"),x=o("v-card"),t=o("v-form"),S=o("v-dialog");return U(),C(S,{"max-width":"500"},{activator:a(({props:k})=>[q(l.$slots,"btn",{activator:k})]),default:a(({isActive:k})=>[e(t,{onSubmit:F(d=>y(k),["prevent"]),ref_key:"formRef",ref:m},{default:a(()=>[e(x,{title:s.value.id?"Editar":"Crear"},{default:a(()=>[e(g,null,{default:a(()=>[e(I,null,{default:a(()=>[e(c,{cols:"12"},{default:a(()=>[e(_,{modelValue:s.value.name,"onUpdate:modelValue":u[0]||(u[0]=d=>s.value.name=d),label:"Nombre",rules:[E(T)]},null,8,["modelValue","rules"])]),_:1}),e(c,{cols:"12"},{default:a(()=>[e(b,{modelValue:s.value.type,"onUpdate:modelValue":u[1]||(u[1]=d=>s.value.type=d),items:[{value:"001",title:"Estudiante"},{value:"002",title:"Docente"},{value:"003",title:"Administrativo"}],label:"Atencion para",rules:[E(T)]},null,8,["modelValue","rules"])]),_:1}),e(c,{cols:"12"},{default:a(()=>[e(D,{label:s.value.status?"Activo":"Inactivo",modelValue:s.value.status,"onUpdate:modelValue":u[2]||(u[2]=d=>s.value.status=d),color:"blue-darken-4",inset:""},null,8,["label","modelValue"])]),_:1})]),_:1})]),_:1}),e(w,null,{default:a(()=>[e(V,{text:"Cancel",onClick:d=>k.value=!1},null,8,["onClick"]),e($),e(V,{text:"Guardar",color:"primary",type:"submit",loading:v.value},null,8,["loading"])]),_:2},1024)]),_:2},1032,["title"])]),_:2},1032,["onSubmit"])]),_:3})}}}),K=A({__name:"DataTable",setup(i){const r=[{title:"Nombre",sortable:!0,value:"name"},{title:"Atencion para",sortable:!0,value:"type"},{title:"Estado",sortable:!0,value:"status"},{title:"",value:"actions"}],p=[{title:"Activo",value:!0},{title:"Inactivo",value:!1}],v=f(!1),n=f({page:1,itemsPerPage:10,search:"",filters:{},sortBy:[],groupBy:""}),m=f({...R}),s=async y=>{v.value=!0,n.value={...n.value,...y,filters:{...n.value.filters}},m.value=await M(n.value),v.value=!1};return(y,l)=>{const u=o("v-btn"),_=o("v-text-field"),c=o("v-col"),b=o("v-select"),D=o("v-row"),I=o("v-card-item"),g=o("v-chip"),V=o("v-data-table-server"),$=o("v-card"),w=G("permission");return U(),C($,null,{default:a(()=>{var x;return[e(I,null,{default:a(()=>[e(D,{justify:"space-between"},{default:a(()=>[e(c,{cols:"12",md:"5",class:"d-flex justify-end align-end"},{default:a(()=>[e(O,{onOnSuccess:l[0]||(l[0]=t=>s(n.value))},{btn:a(({activator:t})=>[B(e(u,N(t,{color:"primary",icon:"mdi-plus-circle-outline",class:"me-2"}),null,16),[[w,["type-attentions.create"]]])]),_:1}),e(_,{modelValue:n.value.search,"onUpdate:modelValue":l[1]||(l[1]=t=>n.value.search=t),label:"Buscar"},null,8,["modelValue"])]),_:1}),e(c,{cols:"12",md:"5",class:"d-flex justify-end align-end"},{default:a(()=>[e(b,{modelValue:n.value.filters.type,"onUpdate:modelValue":[l[2]||(l[2]=t=>n.value.filters.type=t),l[3]||(l[3]=t=>s(n.value))],items:[{value:"001",title:"Estudiante"},{value:"002",title:"Docente"},{value:"003",title:"Administrativo"}],label:"Atencion para",clearable:"",class:"me-2"},null,8,["modelValue"]),e(b,{modelValue:n.value.filters.status,"onUpdate:modelValue":[l[4]||(l[4]=t=>n.value.filters.status=t),l[5]||(l[5]=t=>s(n.value))],label:"Estado",items:p,clearable:""},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(V,{"items-per-page":n.value.itemsPerPage,"onUpdate:itemsPerPage":l[7]||(l[7]=t=>n.value.itemsPerPage=t),headers:r,items:(x=m.value)==null?void 0:x.data,"items-length":m.value.total,search:n.value.search,"multi-sort":"",loading:v.value,"item-value":"id","items-per-page-text":"Número de filas por página:","onUpdate:options":s},{"item.type":a(({item:t})=>[e(g,{color:t.type==="001"?"deep-purple-lighten-2":t.type==="002"?"indigo-lighten-2":"cyan-darken-1"},{default:a(()=>[h(j(t.type==="001"?"Estudiante":t.type==="002"?"Docente":"Administrativo"),1)]),_:2},1032,["color"])]),"item.status":a(({item:t})=>[e(g,{color:t.status?"info":"error"},{default:a(()=>[h(j(t.status?"Activo":"Inactivo"),1)]),_:2},1032,["color"])]),"item.actions":a(({item:t})=>[e(O,{"form-state":t,onOnSuccess:l[6]||(l[6]=S=>s(n.value))},{btn:a(({activator:S})=>[B(e(u,N(S,{density:"comfortable",icon:"mdi-pencil",class:"text-button",variant:"tonal"}),null,16),[[w,["type-attentions.update"]]])]),_:2},1032,["form-state"])]),_:1},8,["items-per-page","items","items-length","search","loading"])]}),_:1})}}}),X=A({__name:"index",setup(i){return(r,p)=>(U(),C(K))}});export{X as default};
