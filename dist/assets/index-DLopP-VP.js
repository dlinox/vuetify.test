import{a as M,D as T}from"./data-table.constants-B0R7xaSt.js";import{y as b,d as D,b as _,r as n,o as P,c as $,w as a,x as j,a as e,f as B,v as R,m as O,g as F,t as G}from"./index-DTYwYFXP.js";const q=async s=>{try{let r=localStorage.getItem("token");return(await b(r).post("/users/items",s)).data}catch(r){return console.error(r),M}},z=async s=>{try{let r=localStorage.getItem("token");return await b(r).post("/users",s),!0}catch(r){return console.error(r),!1}},H=async s=>{try{let r=localStorage.getItem("token");return await b(r).put(`/users/${s.id}`,s),!0}catch(r){return console.error(r),!1}},J=async()=>{try{let s=localStorage.getItem("token");return(await b(s).get("/selects/offices")).data}catch(s){return console.error(s),[]}},K=async()=>{try{let s=localStorage.getItem("token");return(await b(s).get("/selects/roles")).data}catch(s){return console.error(s),[]}},C={id:null,name:"",paternal_surname:"",maternal_surname:"",document_type:"001",document_number:"",office_id:null,role_id:null,email:"",password:"",status:!0,is_editable:!1},E=D({__name:"Form",props:{formState:{type:Object,default:()=>({})},offices:{type:Array,default:()=>[]},roles:{type:Array,default:()=>[]}},emits:["onSuccess"],setup(s,{emit:r}){const c=r,f=_(!1),l=_({...C,...s.formState}),i=async d=>{f.value=!0,l.value.id?await H(l.value)&&(l.value={...C},c("onSuccess"),d.value=!1):await z(l.value)&&(l.value={...C},c("onSuccess"),d.value=!1),f.value=!1};return(d,o)=>{const v=n("v-text-field"),u=n("v-col"),m=n("v-select"),g=n("v-switch"),w=n("v-row"),V=n("v-card-item"),y=n("v-btn"),I=n("v-spacer"),x=n("v-card-actions"),S=n("v-card"),k=n("v-form"),U=n("v-dialog");return P(),$(U,{"max-width":"700"},{activator:a(({props:p})=>[j(d.$slots,"btn",{activator:p})]),default:a(({isActive:p})=>[e(k,{onSubmit:B(t=>i(p),["prevent"])},{default:a(()=>[e(S,{title:l.value.id?"Editar":"Crear"},{default:a(()=>[e(V,null,{default:a(()=>[e(w,null,{default:a(()=>[e(u,{cols:"12",md:"4"},{default:a(()=>[e(v,{modelValue:l.value.document_number,"onUpdate:modelValue":o[0]||(o[0]=t=>l.value.document_number=t),label:"DNI"},null,8,["modelValue"])]),_:1}),e(u,{cols:"12",md:"8"},{default:a(()=>[e(v,{modelValue:l.value.name,"onUpdate:modelValue":o[1]||(o[1]=t=>l.value.name=t),label:"Nombre"},null,8,["modelValue"])]),_:1}),e(u,{cols:"12",md:"6"},{default:a(()=>[e(v,{modelValue:l.value.paternal_surname,"onUpdate:modelValue":o[2]||(o[2]=t=>l.value.paternal_surname=t),label:"Apellido Paterno"},null,8,["modelValue"])]),_:1}),e(u,{cols:"12",md:"6"},{default:a(()=>[e(v,{modelValue:l.value.maternal_surname,"onUpdate:modelValue":o[3]||(o[3]=t=>l.value.maternal_surname=t),label:"Apellido Materno"},null,8,["modelValue"])]),_:1}),e(u,{cols:"12"},{default:a(()=>[e(m,{modelValue:l.value.office_id,"onUpdate:modelValue":o[4]||(o[4]=t=>l.value.office_id=t),items:s.offices,label:"Oficina"},null,8,["modelValue","items"])]),_:1}),e(u,{cols:"12"},{default:a(()=>[e(m,{modelValue:l.value.role_id,"onUpdate:modelValue":o[5]||(o[5]=t=>l.value.role_id=t),items:s.roles,label:"Rol"},null,8,["modelValue","items"])]),_:1}),e(u,{cols:"12"},{default:a(()=>[e(v,{modelValue:l.value.email,"onUpdate:modelValue":o[6]||(o[6]=t=>l.value.email=t),label:"Correo"},null,8,["modelValue"])]),_:1}),e(u,{cols:"12"},{default:a(()=>[e(v,{modelValue:l.value.password,"onUpdate:modelValue":o[7]||(o[7]=t=>l.value.password=t),label:"Contraseña",type:"password",autocomplete:"off"},null,8,["modelValue"])]),_:1}),e(u,{cols:"12"},{default:a(()=>[e(g,{label:l.value.status?"Activo":"Inactivo",modelValue:l.value.status,"onUpdate:modelValue":o[8]||(o[8]=t=>l.value.status=t),color:"blue-darken-4",inset:""},null,8,["label","modelValue"])]),_:1})]),_:1})]),_:1}),e(x,null,{default:a(()=>[e(y,{text:"Cancel",onClick:t=>p.value=!1},null,8,["onClick"]),e(I),e(y,{text:"Guardar",color:"primary",type:"submit",loading:f.value},null,8,["loading"])]),_:2},1024)]),_:2},1032,["title"])]),_:2},1032,["onSubmit"])]),_:3})}}}),L=D({__name:"DataTable",setup(s){const r=_([]),c=_([]),f=[{title:"Nombre",sortable:!0,value:"name"},{title:"Apellido Paterno",sortable:!0,value:"paternal_surname"},{title:"Apellido Materno",sortable:!0,value:"maternal_surname"},{title:"Número de Documento",sortable:!0,value:"document_number"},{title:"Correo Electrónico",sortable:!0,value:"email"},{title:"Estado",sortable:!0,value:"status"},{title:"",value:"actions"}],A=[{title:"Activo",value:!0},{title:"Inactivo",value:!1}],l=_(!1),i=_({...T}),d=_({...M}),o=async u=>{l.value=!0,u.value={...u.value,...u},d.value=await q(u.value),l.value=!1};return R(async()=>{await o(i.value),r.value=await J(),c.value=await K()}),(u,m)=>{const g=n("v-btn"),w=n("v-text-field"),V=n("v-col"),y=n("v-select"),I=n("v-row"),x=n("v-card-item"),S=n("v-chip"),k=n("v-data-table-server"),U=n("v-card");return P(),$(U,null,{default:a(()=>{var p;return[e(x,null,{default:a(()=>[e(I,{justify:"space-between"},{default:a(()=>[e(V,{cols:"12",md:"5",class:"d-flex justify-end align-end"},{default:a(()=>[e(E,{onOnSuccess:m[0]||(m[0]=t=>o(i.value)),offices:r.value,roles:c.value},{btn:a(({activator:t})=>[e(g,O(t,{color:"primary",icon:"mdi-plus-circle-outline",class:"me-2"}),null,16)]),_:1},8,["offices","roles"]),e(w,{modelValue:i.value.search,"onUpdate:modelValue":m[1]||(m[1]=t=>i.value.search=t),label:"Buscar"},null,8,["modelValue"])]),_:1}),e(V,{cols:"12",md:"2"},{default:a(()=>[e(y,{modelValue:i.value.filters.status,"onUpdate:modelValue":[m[2]||(m[2]=t=>i.value.filters.status=t),m[3]||(m[3]=t=>o(i.value))],label:"Estado",items:A,clearable:""},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(k,{"items-per-page":i.value.itemsPerPage,"onUpdate:itemsPerPage":m[5]||(m[5]=t=>i.value.itemsPerPage=t),headers:f,items:(p=d.value)==null?void 0:p.data,"items-length":d.value.total,search:i.value.search,"multi-sort":"",loading:l.value,"item-value":"id","items-per-page-text":"Número de filas por página:","onUpdate:options":o},{"item.status":a(({item:t})=>[e(S,{color:t.status?"info":"error"},{default:a(()=>[F(G(t.status?"Activo":"Inactivo"),1)]),_:2},1032,["color"])]),"item.actions":a(({item:t})=>[e(E,{"form-state":t,onOnSuccess:m[4]||(m[4]=N=>o(i.value)),offices:r.value,roles:c.value},{btn:a(({activator:N})=>[e(g,O(N,{density:"comfortable",icon:"mdi-pencil",class:"text-button",variant:"tonal"}),null,16)]),_:2},1032,["form-state","offices","roles"])]),_:1},8,["items-per-page","items","items-length","search","loading"])]}),_:1})}}}),X=D({__name:"index",setup(s){return(r,c)=>(P(),$(L))}});export{X as default};
