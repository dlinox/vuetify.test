import{a as j,D as q}from"./data-table.constants-B0R7xaSt.js";import{q as h,d as $,b as _,r as t,o as C,c as P,w as l,A as B,a as e,f as E,u as R,z as A,k as M,l as N,m as O,g as z,t as F}from"./index-WbBHlAeq.js";import{r as G}from"./ruleUtils-B_kFGKyT.js";const H=async u=>{try{let s=localStorage.getItem("token");return(await h(s).post("/offices/items",u)).data}catch(s){return console.error(s),j}},J=async u=>{try{let s=localStorage.getItem("token");return await h(s).post("/offices",u),!0}catch(s){return console.error(s),!1}},K=async u=>{try{let s=localStorage.getItem("token");return await h(s).put(`/offices/${u.id}`,u),!0}catch(s){return console.error(s),!1}},D={id:null,name:"",status:!0},T=$({__name:"Form",props:{formState:{type:Object,default:{...D}}},emits:["onSuccess"],setup(u,{emit:s}){const v=s,p=u,r=_(!1),d=_(null),n=_({...D,...p.formState}),U=async c=>{var m;const{valid:a}=await((m=d.value)==null?void 0:m.validate());a&&(r.value=!0,n.value.id?await K(n.value)&&(v("onSuccess"),c.value=!1):await J(n.value)&&(n.value={...D},v("onSuccess"),c.value=!1),r.value=!1)};return(c,a)=>{const m=t("v-text-field"),f=t("v-col"),b=t("v-switch"),x=t("v-row"),V=t("v-card-item"),g=t("v-btn"),S=t("v-spacer"),k=t("v-card-actions"),I=t("v-card"),w=t("v-form"),y=t("v-dialog");return C(),P(y,{"max-width":"500"},{activator:l(({props:o})=>[B(c.$slots,"btn",{activator:o})]),default:l(({isActive:o})=>[e(w,{onSubmit:E(i=>U(o),["prevent"]),ref_key:"formRef",ref:d},{default:l(()=>[e(I,{title:n.value.id?"Editar":"Crear"},{default:l(()=>[e(V,null,{default:l(()=>[e(x,null,{default:l(()=>[e(f,{cols:"12"},{default:l(()=>[e(m,{modelValue:n.value.name,"onUpdate:modelValue":a[0]||(a[0]=i=>n.value.name=i),label:"Nombre",rules:[R(G)]},null,8,["modelValue","rules"])]),_:1}),e(f,{cols:"12"},{default:l(()=>[e(b,{label:n.value.status?"Activo":"Inactivo",modelValue:n.value.status,"onUpdate:modelValue":a[1]||(a[1]=i=>n.value.status=i),color:"primary",inset:"",hint:`Habilitar esta opción permitirá que este elemento sea\r
                      visible y seleccionable en otros formularios.`,"persistent-hint":""},null,8,["label","modelValue"])]),_:1})]),_:1})]),_:1}),e(k,null,{default:l(()=>[e(g,{class:"text-overline",text:"Cancel",onClick:i=>o.value=!1},null,8,["onClick"]),e(S),e(g,{class:"text-overline",text:"Guardar",color:"primary",type:"submit",variant:"tonal",loading:r.value},null,8,["loading"])]),_:2},1024)]),_:2},1032,["title"])]),_:2},1032,["onSubmit"])]),_:3})}}}),L=$({__name:"DataTable",setup(u){const s=[{title:"Nombre",sortable:!0,value:"name"},{title:"Estado",sortable:!0,value:"status"},{title:"",value:"actions"}],v=[{title:"Activo",value:!0},{title:"Inactivo",value:!1}],p=_(!1),r=_({...q}),d=_({...j}),n=async c=>{p.value=!0,c.value={...c.value,...c},d.value=await H(c.value),p.value=!1};return A(async()=>{await n(r.value)}),(c,a)=>{const m=t("v-btn"),f=t("v-text-field"),b=t("v-col"),x=t("v-select"),V=t("v-row"),g=t("v-card-item"),S=t("v-chip"),k=t("v-data-table-server"),I=t("v-card"),w=M("permission");return C(),P(I,null,{default:l(()=>{var y;return[e(g,null,{default:l(()=>[e(V,{justify:"space-between"},{default:l(()=>[e(b,{cols:"12",md:"5",class:"d-flex justify-end align-end"},{default:l(()=>[e(T,{onOnSuccess:a[0]||(a[0]=o=>n(r.value))},{btn:l(({activator:o})=>[N(e(m,O(o,{color:"primary",icon:"mdi-plus-circle-outline",class:"me-2"}),null,16),[[w,["offices.create"]]])]),_:1}),e(f,{modelValue:r.value.search,"onUpdate:modelValue":a[1]||(a[1]=o=>r.value.search=o),label:"Buscar"},null,8,["modelValue"])]),_:1}),e(b,{cols:"12",md:"2"},{default:l(()=>[e(x,{modelValue:r.value.filters.status,"onUpdate:modelValue":[a[2]||(a[2]=o=>r.value.filters.status=o),a[3]||(a[3]=o=>n(r.value))],label:"Estado",items:v,clearable:""},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(k,{"items-per-page":r.value.itemsPerPage,"onUpdate:itemsPerPage":a[5]||(a[5]=o=>r.value.itemsPerPage=o),headers:s,items:(y=d.value)==null?void 0:y.data,"items-length":d.value.total,search:r.value.search,loading:p.value,"multi-sort":"","item-value":"id","items-per-page-text":"Número de filas por página:","onUpdate:options":n},{"item.status":l(({item:o})=>[e(S,{color:o.status?"info":"error"},{default:l(()=>[z(F(o.status?"Activo":"Inactivo"),1)]),_:2},1032,["color"])]),"item.actions":l(({item:o})=>[e(T,{"form-state":o,onOnSuccess:a[4]||(a[4]=i=>n(r.value))},{btn:l(({activator:i})=>[N(e(m,O(i,{density:"comfortable",icon:"mdi-pencil",class:"text-button",variant:"tonal"}),null,16),[[w,["offices.update"]]])]),_:2},1032,["form-state"])]),_:1},8,["items-per-page","items","items-length","search","loading"])]}),_:1})}}}),Y=$({__name:"index",setup(u){return(s,v)=>(C(),P(L))}});export{Y as default};
