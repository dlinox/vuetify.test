import{D as q}from"./data-table.constants-C9jLg9DU.js";import{q as D,d as C,b as d,r as t,o as T,c as U,w as a,x as E,a as e,f as R,u as A,k as F,l as B,m as O,g as G,t as H}from"./index-B0wldPuQ.js";import{r as M}from"./ruleUtils-B_kFGKyT.js";const Q=async u=>{try{let o=localStorage.getItem("token");return(await D(o).post("/offices/items",u)).data}catch(o){return console.error(o),q}},z=async u=>{try{let o=localStorage.getItem("token");return await D(o).post("/offices",u),!0}catch(o){return console.error(o),!1}},J=async u=>{try{let o=localStorage.getItem("token");return await D(o).put(`/offices/${u.id}`,u),!0}catch(o){return console.error(o),!1}},$={id:null,name:"",status:!0},j=C({__name:"Form",props:{formState:{type:Object,default:{...$}}},emits:["onSuccess"],setup(u,{emit:o}){const _=o,b=u,s=d(!1),f=d(null),n=d({...$,...b.formState}),g=async p=>{var i;const{valid:c}=await((i=f.value)==null?void 0:i.validate());c&&(s.value=!0,n.value.id?await J(n.value)&&(_("onSuccess"),p.value=!1):await z(n.value)&&(n.value={...$},_("onSuccess"),p.value=!1),s.value=!1)};return(p,c)=>{const i=t("v-text-field"),l=t("v-col"),y=t("v-switch"),S=t("v-row"),w=t("v-card-item"),x=t("v-btn"),V=t("v-spacer"),k=t("v-card-actions"),h=t("v-card"),I=t("v-form"),P=t("v-dialog");return T(),U(P,{"max-width":"500"},{activator:a(({props:v})=>[E(p.$slots,"btn",{activator:v})]),default:a(({isActive:v})=>[e(I,{onSubmit:R(m=>g(v),["prevent"]),ref_key:"formRef",ref:f},{default:a(()=>[e(h,{title:n.value.id?"Editar":"Crear"},{default:a(()=>[e(w,null,{default:a(()=>[e(S,null,{default:a(()=>[e(l,{cols:"12"},{default:a(()=>[e(i,{modelValue:n.value.name,"onUpdate:modelValue":c[0]||(c[0]=m=>n.value.name=m),label:"Nombre",rules:[A(M)]},null,8,["modelValue","rules"])]),_:1}),e(l,{cols:"12"},{default:a(()=>[e(y,{label:n.value.status?"Activo":"Inactivo",modelValue:n.value.status,"onUpdate:modelValue":c[1]||(c[1]=m=>n.value.status=m),color:"blue-darken-4",inset:"",hint:`Habilitar esta opción permitirá que este elemento sea\r
                      visible y seleccionable en otros formularios.`,"persistent-hint":""},null,8,["label","modelValue"])]),_:1})]),_:1})]),_:1}),e(k,null,{default:a(()=>[e(x,{class:"text-overline",text:"Cancel",color:"secondary",onClick:m=>v.value=!1},null,8,["onClick"]),e(V),e(x,{class:"text-overline",text:"Guardar",color:"primary",type:"submit",variant:"tonal",loading:s.value},null,8,["loading"])]),_:2},1024)]),_:2},1032,["title"])]),_:2},1032,["onSubmit"])]),_:3})}}}),K=C({__name:"DataTable",setup(u){const o=[{title:"Nombre",sortable:!0,value:"name"},{title:"Estado",sortable:!0,value:"status"},{title:"",value:"actions"}],_=[{title:"Activo",value:!0},{title:"Inactivo",value:!1}],b=d(!1),s=d({page:1,itemsPerPage:10,search:"",filters:{},sortBy:[]}),f=d({...q}),n=d(s.value.search);let g;const p=()=>{g&&clearTimeout(g),g=setTimeout(()=>{s.value.search=n.value},400)},c=async i=>{b.value=!0,i.value={...i.value,...i},f.value=await Q(i.value),b.value=!1};return(i,l)=>{const y=t("v-btn"),S=t("v-text-field"),w=t("v-col"),x=t("v-select"),V=t("v-row"),k=t("v-card-item"),h=t("v-chip"),I=t("v-data-table-server"),P=t("v-card"),v=F("permission");return T(),U(P,null,{default:a(()=>{var m;return[e(k,null,{default:a(()=>[e(V,{justify:"space-between"},{default:a(()=>[e(w,{cols:"12",md:"5",class:"d-flex justify-end align-end"},{default:a(()=>[e(j,{onOnSuccess:l[0]||(l[0]=r=>c(s.value))},{btn:a(({activator:r})=>[B(e(y,O(r,{color:"primary",icon:"mdi-plus-circle-outline",class:"me-2"}),null,16),[[v,["offices.create"]]])]),_:1}),e(S,{modelValue:n.value,"onUpdate:modelValue":l[1]||(l[1]=r=>n.value=r),label:"Buscar",onInput:p},null,8,["modelValue"])]),_:1}),e(w,{cols:"12",md:"2"},{default:a(()=>[e(x,{modelValue:s.value.filters.status,"onUpdate:modelValue":[l[2]||(l[2]=r=>s.value.filters.status=r),l[3]||(l[3]=r=>c(s.value))],label:"Estado",items:_,clearable:""},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(I,{"items-per-page":s.value.itemsPerPage,"onUpdate:itemsPerPage":l[5]||(l[5]=r=>s.value.itemsPerPage=r),headers:o,items:(m=f.value)==null?void 0:m.data,"items-length":f.value.total,search:s.value.search,loading:b.value,"multi-sort":"","item-value":"id","items-per-page-text":"Número de filas por página:","onUpdate:options":c},{"item.status":a(({item:r})=>[e(h,{color:r.status?"info":"error"},{default:a(()=>[G(H(r.status?"Activo":"Inactivo"),1)]),_:2},1032,["color"])]),"item.actions":a(({item:r})=>[e(j,{"form-state":r,onOnSuccess:l[4]||(l[4]=N=>c(s.value))},{btn:a(({activator:N})=>[B(e(y,O(N,{density:"comfortable",icon:"mdi-pencil",class:"text-button",variant:"tonal",color:"black"}),null,16),[[v,["offices.update"]]])]),_:2},1032,["form-state"])]),_:1},8,["items-per-page","items","items-length","search","loading"])]}),_:1})}}}),Y=C({__name:"index",setup(u){return(o,_)=>(T(),U(K))}});export{Y as default};
