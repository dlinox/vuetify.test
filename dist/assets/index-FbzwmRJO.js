import{D as j}from"./data-table.constants-C9jLg9DU.js";import{q as $,d as h,b as f,r as t,o as D,c as C,w as a,z as E,a as e,f as O,u as R,k as q,l as U,m as B,g as A,t as z}from"./index-BFgRTA9O.js";import{r as F}from"./ruleUtils-B_kFGKyT.js";const G=async u=>{try{let l=localStorage.getItem("token");return(await $(l).post("/types-attention/items",u)).data}catch(l){return console.error(l),j}},M=async u=>{try{let l=localStorage.getItem("token");return await $(l).post("/types-attention",u),!0}catch(l){return console.error(l),!1}},H=async u=>{try{let l=localStorage.getItem("token");return await $(l).put(`/types-attention/${u.id}`,u),!0}catch(l){return console.error(l),!1}},N={id:null,name:"",status:!0},T=h({__name:"Form",props:{formState:{type:Object,default:()=>({})}},emits:["onSuccess"],setup(u,{emit:l}){const d=l,i=f(!1),r=u,_=f(null),n=f({...N,...r.formState}),m=async o=>{var p;const{valid:c}=await((p=_.value)==null?void 0:p.validate());c&&(i.value=!0,n.value.id?await H(n.value)&&(d("onSuccess"),o.value=!1):await M(n.value)&&(n.value={...N},d("onSuccess"),o.value=!1),i.value=!1,n.value={id:null,name:"",status:!0})};return(o,c)=>{const p=t("v-text-field"),b=t("v-col"),V=t("v-switch"),S=t("v-row"),k=t("v-card-item"),y=t("v-btn"),I=t("v-spacer"),P=t("v-card-actions"),w=t("v-card"),x=t("v-form"),s=t("v-dialog");return D(),C(s,{"max-width":"500"},{activator:a(({props:v})=>[E(o.$slots,"btn",{activator:v})]),default:a(({isActive:v})=>[e(x,{onSubmit:O(g=>m(v),["prevent"]),ref_key:"formRef",ref:_},{default:a(()=>[e(w,{title:n.value.id?"Editar":"Crear"},{default:a(()=>[e(k,null,{default:a(()=>[e(S,null,{default:a(()=>[e(b,{cols:"12"},{default:a(()=>[e(p,{modelValue:n.value.name,"onUpdate:modelValue":c[0]||(c[0]=g=>n.value.name=g),label:"Nombre",rules:[R(F)]},null,8,["modelValue","rules"])]),_:1}),e(b,{cols:"12"},{default:a(()=>[e(V,{label:n.value.status?"Activo":"Inactivo",modelValue:n.value.status,"onUpdate:modelValue":c[1]||(c[1]=g=>n.value.status=g),color:"blue-darken-4",inset:""},null,8,["label","modelValue"])]),_:1})]),_:1})]),_:1}),e(P,null,{default:a(()=>[e(y,{text:"Cancel",onClick:g=>v.value=!1},null,8,["onClick"]),e(I),e(y,{text:"Guardar",color:"primary",type:"submit",loading:i.value},null,8,["loading"])]),_:2},1024)]),_:2},1032,["title"])]),_:2},1032,["onSubmit"])]),_:3})}}}),J=h({__name:"DataTable",setup(u){const l=[{title:"Nombre",sortable:!0,value:"name"},{title:"Estado",sortable:!0,value:"status"},{title:"",value:"actions"}],d=[{title:"Activo",value:!0},{title:"Inactivo",value:!1}],i=f(!1),r=f({page:1,itemsPerPage:10,search:"",filters:{},sortBy:[],groupBy:""}),_=f({...j}),n=async m=>{i.value=!0,m.value={...m.value,...m},_.value=await G(m.value),i.value=!1};return(m,o)=>{const c=t("v-btn"),p=t("v-text-field"),b=t("v-col"),V=t("v-select"),S=t("v-row"),k=t("v-card-item"),y=t("v-chip"),I=t("v-data-table-server"),P=t("v-card"),w=q("permission");return D(),C(P,null,{default:a(()=>{var x;return[e(k,null,{default:a(()=>[e(S,{justify:"space-between"},{default:a(()=>[e(b,{cols:"12",md:"5",class:"d-flex justify-end align-end"},{default:a(()=>[e(T,{onOnSuccess:o[0]||(o[0]=s=>n(r.value))},{btn:a(({activator:s})=>[U(e(c,B(s,{color:"primary",icon:"mdi-plus-circle-outline",class:"me-2"}),null,16),[[w,["type-attentions.create"]]])]),_:1}),e(p,{modelValue:r.value.search,"onUpdate:modelValue":o[1]||(o[1]=s=>r.value.search=s),label:"Buscar"},null,8,["modelValue"])]),_:1}),e(b,{cols:"12",md:"2"},{default:a(()=>[e(V,{modelValue:r.value.filters.status,"onUpdate:modelValue":[o[2]||(o[2]=s=>r.value.filters.status=s),o[3]||(o[3]=s=>n(r.value))],label:"Estado",items:d,clearable:""},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(I,{"items-per-page":r.value.itemsPerPage,"onUpdate:itemsPerPage":o[5]||(o[5]=s=>r.value.itemsPerPage=s),headers:l,items:(x=_.value)==null?void 0:x.data,"items-length":_.value.total,search:r.value.search,"multi-sort":"",loading:i.value,"item-value":"id","items-per-page-text":"Número de filas por página:","onUpdate:options":n},{"item.status":a(({item:s})=>[e(y,{color:s.status?"info":"error"},{default:a(()=>[A(z(s.status?"Activo":"Inactivo"),1)]),_:2},1032,["color"])]),"item.actions":a(({item:s})=>[e(T,{"form-state":s,onOnSuccess:o[4]||(o[4]=v=>n(r.value))},{btn:a(({activator:v})=>[U(e(c,B(v,{density:"comfortable",icon:"mdi-pencil",class:"text-button",variant:"tonal"}),null,16),[[w,["type-attentions.update"]]])]),_:2},1032,["form-state"])]),_:1},8,["items-per-page","items","items-length","search","loading"])]}),_:1})}}}),W=h({__name:"index",setup(u){return(l,d)=>(D(),C(J))}});export{W as default};
