import{D as R}from"./data-table.constants-C9jLg9DU.js";import{q as P,d as A,b as y,r as o,o as U,c as C,w as a,x as q,a as e,f as F,u as E,k as G,l as B,m as N,g as h,t as j}from"./index-BRh64UmY.js";import{r as T}from"./ruleUtils-B_kFGKyT.js";const M=async i=>{try{let s=localStorage.getItem("token");return(await P(s).post("/types-attention/items",i)).data}catch(s){return console.error(s),R}},z=async i=>{try{let s=localStorage.getItem("token");return await P(s).post("/types-attention",i),!0}catch(s){return console.error(s),!1}},H=async i=>{try{let s=localStorage.getItem("token");return await P(s).put(`/types-attention/${i.id}`,i),!0}catch(s){return console.error(s),!1}},J={id:null,type:null,name:"",status:!0},O=A({__name:"Form",props:{formState:{type:Object,default:()=>({})}},emits:["onSuccess"],setup(i,{emit:s}){const _=s,v=y(!1),r=i,m=y(null),n=y({...J,...r.formState}),d=async l=>{var f,c;const{valid:u}=await((f=m.value)==null?void 0:f.validate());u&&(v.value=!0,n.value.id?await H(n.value)&&(_("onSuccess"),l.value=!1):await z(n.value)&&((c=m.value)==null||c.reset(),_("onSuccess"),l.value=!1),v.value=!1)};return(l,u)=>{const f=o("v-text-field"),c=o("v-col"),b=o("v-select"),D=o("v-switch"),I=o("v-row"),g=o("v-card-item"),V=o("v-btn"),$=o("v-spacer"),w=o("v-card-actions"),x=o("v-card"),t=o("v-form"),k=o("v-dialog");return U(),C(k,{"max-width":"500"},{activator:a(({props:S})=>[q(l.$slots,"btn",{activator:S})]),default:a(({isActive:S})=>[e(t,{onSubmit:F(p=>d(S),["prevent"]),ref_key:"formRef",ref:m},{default:a(()=>[e(x,{title:n.value.id?"Editar":"Crear"},{default:a(()=>[e(g,null,{default:a(()=>[e(I,null,{default:a(()=>[e(c,{cols:"12"},{default:a(()=>[e(f,{modelValue:n.value.name,"onUpdate:modelValue":u[0]||(u[0]=p=>n.value.name=p),label:"Nombre",rules:[E(T)]},null,8,["modelValue","rules"])]),_:1}),e(c,{cols:"12"},{default:a(()=>[e(b,{modelValue:n.value.type,"onUpdate:modelValue":u[1]||(u[1]=p=>n.value.type=p),items:[{value:"001",title:"Estudiante"},{value:"002",title:"Docente"},{value:"003",title:"Administrativo"}],label:"Atencion para",rules:[E(T)]},null,8,["modelValue","rules"])]),_:1}),e(c,{cols:"12"},{default:a(()=>[e(D,{label:n.value.status?"Activo":"Inactivo",modelValue:n.value.status,"onUpdate:modelValue":u[2]||(u[2]=p=>n.value.status=p),color:"blue-darken-4",inset:""},null,8,["label","modelValue"])]),_:1})]),_:1})]),_:1}),e(w,null,{default:a(()=>[e(V,{text:"Cancel",onClick:p=>S.value=!1},null,8,["onClick"]),e($),e(V,{text:"Guardar",color:"primary",type:"submit",loading:v.value},null,8,["loading"])]),_:2},1024)]),_:2},1032,["title"])]),_:2},1032,["onSubmit"])]),_:3})}}}),K=A({__name:"DataTable",setup(i){const s=[{title:"Nombre",sortable:!0,value:"name"},{title:"Atencion para",sortable:!0,value:"type"},{title:"Estado",sortable:!0,value:"status"},{title:"",value:"actions"}],_=[{title:"Activo",value:!0},{title:"Inactivo",value:!1}],v=y(!1),r=y({page:1,itemsPerPage:10,search:"",filters:{},sortBy:[],groupBy:""}),m=y({...R}),n=async d=>{v.value=!0,d.value={...d.value,...d},m.value=await M(d.value),v.value=!1};return(d,l)=>{const u=o("v-btn"),f=o("v-text-field"),c=o("v-col"),b=o("v-select"),D=o("v-row"),I=o("v-card-item"),g=o("v-chip"),V=o("v-data-table-server"),$=o("v-card"),w=G("permission");return U(),C($,null,{default:a(()=>{var x;return[e(I,null,{default:a(()=>[e(D,{justify:"space-between"},{default:a(()=>[e(c,{cols:"12",md:"5",class:"d-flex justify-end align-end"},{default:a(()=>[e(O,{onOnSuccess:l[0]||(l[0]=t=>n(r.value))},{btn:a(({activator:t})=>[B(e(u,N(t,{color:"primary",icon:"mdi-plus-circle-outline",class:"me-2"}),null,16),[[w,["type-attentions.create"]]])]),_:1}),e(f,{modelValue:r.value.search,"onUpdate:modelValue":l[1]||(l[1]=t=>r.value.search=t),label:"Buscar"},null,8,["modelValue"])]),_:1}),e(c,{cols:"12",md:"5",class:"d-flex justify-end align-end"},{default:a(()=>[e(b,{modelValue:r.value.filters.type,"onUpdate:modelValue":[l[2]||(l[2]=t=>r.value.filters.type=t),l[3]||(l[3]=t=>n(r.value))],items:[{value:"001",title:"Estudiante"},{value:"002",title:"Docente"},{value:"003",title:"Administrativo"}],label:"Atencion para",clearable:"",class:"me-2"},null,8,["modelValue"]),e(b,{modelValue:r.value.filters.status,"onUpdate:modelValue":[l[4]||(l[4]=t=>r.value.filters.status=t),l[5]||(l[5]=t=>n(r.value))],label:"Estado",items:_,clearable:""},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(V,{"items-per-page":r.value.itemsPerPage,"onUpdate:itemsPerPage":l[7]||(l[7]=t=>r.value.itemsPerPage=t),headers:s,items:(x=m.value)==null?void 0:x.data,"items-length":m.value.total,search:r.value.search,"multi-sort":"",loading:v.value,"item-value":"id","items-per-page-text":"Número de filas por página:","onUpdate:options":n},{"item.type":a(({item:t})=>[e(g,{color:t.type==="001"?"deep-purple-lighten-2":t.type==="002"?"indigo-lighten-2":"cyan-darken-1"},{default:a(()=>[h(j(t.type==="001"?"Estudiante":t.type==="002"?"Docente":"Administrativo"),1)]),_:2},1032,["color"])]),"item.status":a(({item:t})=>[e(g,{color:t.status?"info":"error"},{default:a(()=>[h(j(t.status?"Activo":"Inactivo"),1)]),_:2},1032,["color"])]),"item.actions":a(({item:t})=>[e(O,{"form-state":t,onOnSuccess:l[6]||(l[6]=k=>n(r.value))},{btn:a(({activator:k})=>[B(e(u,N(k,{density:"comfortable",icon:"mdi-pencil",class:"text-button",variant:"tonal"}),null,16),[[w,["type-attentions.update"]]])]),_:2},1032,["form-state"])]),_:1},8,["items-per-page","items","items-length","search","loading"])]}),_:1})}}}),X=A({__name:"index",setup(i){return(s,_)=>(U(),C(K))}});export{X as default};
